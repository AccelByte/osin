// Copyright (c) 2021 AccelByte Inc. All Rights Reserved.
// This is licensed software from AccelByte Inc, for limitations
// and restrictions contact your company contract manager.

package osin

import "testing"

func TestGetExpirationTime_AccessToken(t *testing.T) {
	accessToken := "eyJhbGciOiJSUzI1NiIsImtpZCI6IjlmZDRjZDVmOTkxY2ViZTMzMjM2MDVjZDEyZDNiOGJmZGZjNzNmYTQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOlsiaHR0cHM6Ly9hcGkuZGV2LmFjY2VsYnl0ZS5pbyIsImh0dHBzOi8vYXBpLmRldi5hY2NlbGJ5dGUuaW8vYmFzaWMiLCIiLCIiLCIiLCIiXSwiYmFucyI6W10sImNsaWVudF9pZCI6ImI4NTY5M2U0ODY1OTQ5YWQ4OGJkYTYwN2E1MzlmM2NkIiwiY291bnRyeSI6IklEIiwiZGlzcGxheV9uYW1lIjoiTWFyc2VsIDEiLCJleHAiOjE2MTc3ODMyMzgsImlhdCI6MTYxNzc3OTYzOCwiamZsZ3MiOjEsIm5hbWVzcGFjZSI6ImFjY2VsYnl0ZSIsIm5hbWVzcGFjZV9yb2xlcyI6bnVsbCwicGVybWlzc2lvbnMiOltdLCJyb2xlcyI6WyIyMjUxNDM4ODM5ZTk0OGQ3ODNlYzBlNTI4MWRhZjA1YiIsIjM2ZDc4ZDRhYTFiMDRkNDZiODIzODlkOWExMmU5YWViIl0sInNjb3BlIjoiYWNjb3VudCBjb21tZXJjZSBzb2NpYWwgcHVibGlzaGluZyBhbmFseXRpY3MiLCJzdWIiOiIzZjFkODdhMDQ3Yjk0NTM2Yjg1MTk5NTBkOGQ0NDhiMyJ9.Z2H7W2sNor-_SFCwWEAB-Rwh9Fjz6rOErZnY2Gj4TpnFQjS3T9atRDHt4Py2BF6urLcRZK6xOuL96-yR_WPxjjsj32WgZx_EhIsmWWhVQZFhVuuw1Ls3c2pohu2hAZ6cpzoHiNb_3MTAj0RSR0HoVUyiLlWa34IRvvOITbtBa2CJa1Uhvfx_ECN35C3GpUcmNbOBkZHnFRuQ6n6CfbzEEyLTC0P3DjRnMqK9FSn-E3EnCJV2dWZhzBMaLm4P610rVHb37_RxoKP8T706frkZiUE7Zb-j0AUuuQKBKAsfhVgkoEetyVHP0n25cpdNJu1c9WJG-gbaUCWZ9tnuKtVqDA"
	expirationTime := getExpirationTime(accessToken)
	if int64(1617783238) != expirationTime.Unix() {
		t.Errorf("Expected expirationTime is 1617866038, got %v", expirationTime.Unix())
	}
}

func TestGetExpirationTime_RefreshToken(t *testing.T) {
	refreshToken := "eyJhbGciOiJSUzI1NiIsImtpZCI6IjlmZDRjZDVmOTkxY2ViZTMzMjM2MDVjZDEyZDNiOGJmZGZjNzNmYTQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOlsiaHR0cHM6Ly9hcGkuZGV2LmFjY2VsYnl0ZS5pbyIsImh0dHBzOi8vYXBpLmRldi5hY2NlbGJ5dGUuaW8vYmFzaWMiLCIiLCIiLCIiLCIiXSwiY2xpZW50X2lkIjoiYjg1NjkzZTQ4NjU5NDlhZDg4YmRhNjA3YTUzOWYzY2QiLCJleHAiOjE2MTc4NjYwMzgsImlhdCI6MTYxNzc3OTYzOCwibmFtZXNwYWNlIjoiYWNjZWxieXRlIiwic3ViIjoiM2YxZDg3YTA0N2I5NDUzNmI4NTE5OTUwZDhkNDQ4YjMifQ.jHBGVMY4tHSLzej39YanGla30_tl1lrQ867HGWA_Mx9n1y2hCbV_Oy6rJCEPI93qk7av-9AxI3RF_f5CPZRy7U3rvnKBEI_FImNg6_FUCaoUeGUv_y1R9d2F5zEj8XFs_qZuHtBhiUkYksJvo6teM4ctEv0DSq4lLyQtX1Mp2DA-GN0O8tnaeT2hWy_Te1P3nkjzyBrbeCM4cMw0ScQr-41F_DO6yJuOnSy32pE8eNDXwzNixe96Mrvfr7XnfSADqrCHVLoMrsQNpsrvXZ-MpJHLkViQ9d2PG6uSLlFUtrearApwCH4IlK6e3-Cx-QyF1q1FqJ36czvkD7crokfuvA"
	expirationTime := getExpirationTime(refreshToken)
	if int64(1617866038) != expirationTime.Unix() {
		t.Errorf("Expected expirationTime is 1617866038, got %v", expirationTime.Unix())
	}
}
